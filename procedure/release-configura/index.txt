Notes on making an MPS release for Configura.  

You need a Windows box.  I used sandpiper, which has P4, VisualC++, and cygwin on it already.  

__ACCESS__

Set-up a login and password if necessary.  To prevent pwd expiry, use Start > Programs > Admin Tools > User Manager.

If you want to access remotely from a Mac, use "Chicken of the VNC", eg. 2.02b2.  You'll need the VNC session-password (not the same as your NT login password).  Remember how to escape from Full-screen: Cmd-Opt-Ctrl-` (backquote); and how to right-click: depress and release Shift-key, then click.  

To copy files across, mount sandpiper's disk on your Mac.  Finder > Go > Network > Network > Ravenbrook > Sandpiper.  Be patient: list of servers may take some seconds to fully update/populate.  To make cmd windows tab-complete filenames, do this:  Start > Run > regedit.  HKEY_CURRENT_USER > Software > Microsoft > Command Processor > CompletionChar = 9.  


__VERSION__

You should be making a release from a known version.  See <http://info.ravenbrook.com/project/mps/master/procedure/release-build/>.


__BUILD__

Start > Programs > P4Win.  Set-up a P4 client (rhsk-sandpiper).  It should be using port 1666.  There is no need to ssh / tunnel, because sandpiper is on the Ravenbrook ethernet.  Set-up the client map.  P4sync to check it's working.  

Or, for command-line p4, first need to do "p4 set" to set P4USER, P4CLIENT, and P4PORT (eg. "p4 set P4USER=rhsk").  

First, clean out the place code will be built in, and get the right changelevel'd version.  See <http://info.ravenbrook.com/project/mps/master/procedure/release-build/>.

cd ....\master\code

"C:\Program Files\Microsoft Visual Studio\VC98\Bin\vcvars32.bat".  (This also sets up the path so you can just type "nmake").  

Invoke w3build.

(
you might think that "C:\Program Files\Microsoft Visual Studio\VC98\Bin\nmake.exe" /f w3i3mv.nmk
is right, but no, you want:  //info.ravenbrook.com/project/mps/master/code/w3build.bat
)

This makes a release directory, eg:
duck:/Volumes/SANDPIPER-C/rhsk/master/code/release richardk$ find . '-type' d '-print'
.
./include
./lib
./lib/w3i3
./lib/w3i3/ce
./lib/w3i3/ci
./lib/w3i3/we
./lib/w3i3/wi
./src

For 1.105.0, DRJ made a .tar.gz of this, probably with "tar cf foo.tar dir | gzip -c" on sandpiper.  (Sandpiper has cygwin, which includes GNU tar, etc.)  

p4 add this under mps/release, and update infosys.  See <http://info.ravenbrook.com/project/mps/master/procedure/release-build/>.

Email it as an attachment.  See <http://info.ravenbrook.com/mail/2005/02/16/13-53-46/0.txt>


Further comment:
DRJ: 28 September 2005 12:08:00 BDT
NB:  28 September 2005 13:04:57 BDT
$Id$
